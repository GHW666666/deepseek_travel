import{_ as j,r as d,k as M,H as P,b as n,J as r,R as f,U as y,V as N,I as O,W as _}from"./index-BmxogOyr.js";import{a as p,b as B}from"./index-COYSASPr.js";const x="http://localhost:7000",D={async submit(u){try{const o=await(await fetch(`${x}/complaint/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).json();return o.code===200?{success:!0,data:o.data,message:o.message}:{success:!1,message:o.message}}catch(a){return console.error("提交投诉失败:",a),{success:!1,message:"网络错误，请稍后重试"}}},async getList(){try{const a=await(await fetch(`${x}/complaint/list`)).json();return a.code===200?{success:!0,data:a.data,message:a.message}:{success:!1,message:a.message}}catch(u){return console.error("获取投诉列表失败:",u),{success:!1,message:"网络错误，请稍后重试"}}},async getDetail(u){try{const o=await(await fetch(`${x}/complaint/detail`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:u})})).json();return o.code===200?{success:!0,data:o.data,message:o.message}:{success:!1,message:o.message}}catch(a){return console.error("获取投诉详情失败:",a),{success:!1,message:"网络错误，请稍后重试"}}},async updateStatus(u,a){try{const m=await(await fetch(`${x}/complaint/updateStatus`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:u,status:a})})).json();return m.code===200?{success:!0,data:m.data,message:m.message}:{success:!1,message:m.message}}catch(o){return console.error("更新投诉状态失败:",o),{success:!1,message:"网络错误，请稍后重试"}}}},J={class:"complaint-page"},L={class:"complaint-page"},A={class:"complaint-page"},I={class:"complaint-page"},R={class:"complaint-page"},E={__name:"index",setup(u){const a=N(),o=d(!1),m=()=>{a.push("/")},t=M({name:"",phone:"",target:"",reason:"",location:"",demand:"",travelMethod:""});d(""),d(""),d("");const v=d(!1),c=d(!1),g=d(!1),C=[{text:"自由行",value:"自由行"},{text:"跟团游",value:"跟团游"}],w=[{text:"昆明",value:"昆明"},{text:"大理",value:"大理"},{text:"丽江",value:"丽江"},{text:"香格里拉",value:"香格里拉"},{text:"西双版纳",value:"西双版纳"}],h=({selectedOptions:l})=>{v.value=!1,t.target=l[0].text},k=({selectedOptions:l})=>{c.value=!1,t.location=l[0].text},S=({selectedOptions:l})=>{g.value=!1,t.travelMethod=l[0].text},T=async()=>{if(!t.name.trim()){p("请输入姓名");return}if(!t.phone.trim()){p("请输入电话号码");return}if(!t.target.trim()){p("请选择投诉对象");return}if(!t.reason.trim()){p("请输入投诉原因");return}o.value=!0;try{const l=await D.submit({name:t.name,phone:t.phone,target:t.target,reason:t.reason,location:t.location,demand:t.demand,travelMethod:t.travelMethod});l.success?(B("投诉提交成功"),setTimeout(()=>{a.push("/")},1500)):p(l.message||"提交失败")}catch(l){console.error("提交投诉失败:",l),p("网络错误，请稍后重试")}finally{o.value=!1}};return(l,e)=>{const U=f("van-nav-bar"),i=f("van-field"),b=f("van-picker"),V=f("van-popup"),$=f("van-button");return O(),P("div",null,[n(U,{title:"投诉","left-arrow":"",fixed:"",placeholder:"false",onClickLeft:m}),r("div",J,[e[14]||(e[14]=r("p",{class:"title-text"},"你要投诉谁",-1)),n(i,{modelValue:t.target,"onUpdate:modelValue":e[0]||(e[0]=s=>t.target=s),"is-link":"",readonly:"",label:"投诉",placeholder:"选择投诉对象",onClick:e[1]||(e[1]=s=>v.value=!0)},null,8,["modelValue"]),n(V,{show:v.value,round:"",position:"bottom"},{default:y(()=>[n(b,{columns:w,onCancel:e[2]||(e[2]=s=>v.value=!1),onConfirm:h})]),_:1},8,["show"])]),r("div",L,[e[15]||(e[15]=r("p",{class:"title-text"},"请告诉我们发生了什么事",-1)),n(i,{modelValue:t.reason,"onUpdate:modelValue":e[3]||(e[3]=s=>t.reason=s),class:"input-text",type:"textarea",placeholder:"请输入投诉原因"},null,8,["modelValue"])]),r("div",A,[e[16]||(e[16]=r("p",{class:"title-text"},"这件事发生在哪里",-1)),n(i,{modelValue:t.location,"onUpdate:modelValue":e[4]||(e[4]=s=>t.location=s),"is-link":"",readonly:"",label:"投诉",placeholder:"选择投诉地区",onClick:e[5]||(e[5]=s=>c.value=!0)},null,8,["modelValue"]),n(V,{show:c.value,"onUpdate:show":e[7]||(e[7]=s=>c.value=s),round:"",position:"bottom"},{default:y(()=>[n(b,{columns:w,onCancel:e[6]||(e[6]=s=>c.value=!1),onConfirm:k})]),_:1},8,["show"])]),r("div",I,[e[17]||(e[17]=r("p",{class:"title-text"},"你的诉求是",-1)),n(i,{modelValue:t.demand,"onUpdate:modelValue":e[8]||(e[8]=s=>t.demand=s),class:"input-text",type:"textarea",placeholder:"点击输入"},null,8,["modelValue"])]),r("div",R,[e[18]||(e[18]=r("p",{class:"title-text"}," 最后我们需要了解您的个人信息，用于核实事件以及告知 ",-1)),n(i,{modelValue:t.name,"onUpdate:modelValue":e[9]||(e[9]=s=>t.name=s),label:"你的姓名",placeholder:"请输入姓名"},null,8,["modelValue"]),n(i,{modelValue:t.phone,"onUpdate:modelValue":e[10]||(e[10]=s=>t.phone=s),type:"tel",label:"你的联系方式",placeholder:"请输入电话号码"},null,8,["modelValue"]),n(i,{modelValue:t.travelMethod,"onUpdate:modelValue":e[11]||(e[11]=s=>t.travelMethod=s),"is-link":"",readonly:"",placeholder:"你在云南是如何旅行的",onClick:e[12]||(e[12]=s=>g.value=!0)},null,8,["modelValue"]),n(V,{show:g.value,round:"",position:"bottom"},{default:y(()=>[n(b,{columns:C,onCancel:e[13]||(e[13]=s=>g.value=!1),onConfirm:S})]),_:1},8,["show"])]),n($,{class:"submit-button",type:"primary",onClick:T,loading:o.value},{default:y(()=>[...e[19]||(e[19]=[_("提交投诉",-1)])]),_:1},8,["loading"])])}}},W=j(E,[["__scopeId","data-v-d169bfb0"]]);export{W as default};
